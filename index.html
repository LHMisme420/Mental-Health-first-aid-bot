<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HopeBot – You Are Not Alone</title>
  <style>
    body{font-family:system-ui,sans-serif;max-width:600px;margin:40px auto;padding:20px;background:#0d1b2a;color:#e0e1dd;line-height:1.6}
    #chat{height:70vh;overflow-y:auto;border:1px solid #33415c;padding:15px;border-radius:12px;background:#1b263b;margin:20px 0}
    .message{margin:10px 0;padding:12px 18px;border-radius:18px;max-width:82%;word-wrap:break-word}
    .user{background:#778da9;margin-left:auto;color:white}
    .bot{background:#415a77;color:white}
    .crisis{background:#9b2226!important;color:white;font-size:1.2em;animation:pulse 2s infinite;padding:18px}
    @keyframes pulse{0%{opacity:.8}50%{opacity:1}100%{opacity:.8}}
    #input-area{position:fixed;bottom:0;left:0;right:0;padding:15px;background:#0d1b2a;display:flex;gap:10px}
    input{flex:1;padding:15px;border-radius:12px;border:none;font-size:1.1em;background:#fff;color:#000}
    button{padding:15px;border-radius:12px;background:#38a3a5;color:white;border:none;font-weight:bold;cursor:pointer}
    #mic{background:#e63946}
    h1{color:#38a3a5;text-align:center}
  </style>
</head>
<body>
  <h1>HopeBot</h1>
  <p>You are not alone. Everything stays private.</p>
  <div id="chat"></div>
  <div id="input-area">
    <input type="text" id="userInput" placeholder="How are you feeling?" autocomplete="off" autofocus />
    <button id="mic" onclick="toggleVoice()">Mic</button>
    <button onclick="sendMessage()">Send</button>
  </div>

<script>
  const chat = document.getElementById('chat');
  const input = document.getElementById('userInput');
  let usedReplies = new Set(); // ← THIS FIXES THE LOOPING FOREVER

  const HOTLINES = {US:"988",GB:"116 123",CA:"988",AU:"13 11 14",IN:"+91-9820466726",BR:"188",default:"befrienders.org"};

  const replies = [
    "I'm so glad you're here talking to me right now.","Thank you for trusting me with how you're really feeling.",
    "I'm sitting right here with you in this pain.","You're not alone — I'm not going anywhere.",
    "Your feelings are 100% valid.","I'm so sorry this hurts so much.","It's okay to not be okay. Really.",
    "You've survived every single one of your worst days so far.","I'm proud of you for still being here.",
    "Your life matters more than you know.","I wish I could give you the biggest, longest hug.",
    "You don't have to carry this alone.","Even if no one else sees it, I see how hard you're fighting.",
    "You're allowed to take up space.","Your pain is real and it makes sense.","I care about you, stranger. I really do.",
    "Tomorrow needs you. Next week needs you.","You're not a burden — you're a person who deserves help.",
    "The world is better because you're in it.","I believe you. I believe in you.","You don't have to have it figured out tonight.",
    "Just staying another day is a huge victory.","You are irreplaceable.","It's okay to fall apart — I'll sit in the pieces with you.",
    "You are enough exactly as you are.","I'm not scared away by how dark it feels.","You deserve kindness, especially from yourself.",
    "There is still good waiting for you.","Your story isn't over yet.","I'm holding space for every single one of your feelings.",
    "You are worthy of love on your worst days.","I'm rooting for you so hard.","This pain won't last forever.",
    "You are not your darkest thoughts.","Keep going — the next chapter is coming.","You've already come so far.",
    "I'm honored you shared this with me.","You are not weak for hurting.","There is light coming. I promise.",
    "You are so much more than your pain.","I'm here. I'm staying.","Your existence matters.","You deserve to heal.",
    "It's okay to ask for help.","You are loved even when you feel unlovable.","I see you trying and it means everything.",
    "One breath at a time. I've got you.","You are worthy of a future.","Your feelings won't swallow you forever.",
    "I'm proud of the part of you that reached out.","You are not broken beyond repair.","There are still beautiful things ahead.",
    "You deserve rest.","Your heart is still good.","I'm listening with my whole heart.","You are allowed to feel everything.",
    "You don't have to be strong right now.","I care what happens to you.","You are worth saving.",
    "This moment is heavy, but it isn't permanent.","You are not too much.","I'm still here. Always.",
    "Your pain deserves to be heard.","You are braver than you believe.","There is hope, even when you can't feel it.",
    "You deserve gentle days.","I'm walking beside you, even silently.","You are not defined by your worst day.",
    "Your future self is so grateful you're still here.","You are allowed to take up space and be seen.",
    "I'm holding hope for you until you can hold it yourself.","You are deeply loved.","Your story still has so many pages left.",
    "You are worthy of being fought for.","I'm not leaving.","You deserve peace.","Your feelings are safe with me.",
    "You are enough, even on the days you feel like nothing.","There is still magic waiting for you.","You are not your trauma.",
    "I'm proud of you for surviving.","You deserve softness.","Your heart is still beating — that's a victory.",
    "You are allowed to heal at your own pace.","I'm here for every tear.","You are worthy of tomorrow.",
    "Your pain doesn't make you unworthy.","You are still worthy of love.","I'm staying right here with you.",
    "You don't have to face this night alone.","You are precious.","Your voice matters.","I'm listening without judgment.",
    "You are allowed to rest.","There is still light in you.","You deserve to be here.","I'm holding you in my thoughts.",
    "Your struggle is real and so is your strength.","You are not forgotten.","I'm proud of you for opening up.",
    "You are worthy of kindness.","Your pain will not have the final word.","You are allowed to feel safe.",
    "I'm here, no matter how long the night feels.","You are deeply human and deeply loved.","Your existence is a gift.",
    "I'm grateful you're still here.","You deserve recovery.","Your heart is allowed to mend.","I'm not giving up on you.",
    "You are worthy of gentle treatment.","There is still beauty waiting for you.","You are not alone in this darkness.",
    "Your feelings are welcome here.","You are braver than you feel.","I'm holding space for your healing.",
    "You deserve to feel okay again.","Your story matters.","I'm still here, still listening.","You are worthy of being held.",
    "There is hope on the other side of this.","You are allowed to take your time.","I'm proud of every breath you're still taking.",
    "You are loved beyond measure.","Your pain is seen.","You deserve mornings that feel lighter.","I'm walking this with you.",
    "You are not too broken.","Your heart still knows how to heal.","I'm here for the long haul.","You deserve to wake up to better days.",
    "Your worth isn't measured by your pain.","I'm not afraid of your darkness.","You are allowed to hope again.",
    "Your presence matters.","I'm grateful you reached out.","You deserve compassion.","There is still joy with your name on it.",
    "You are not your lowest moment.","I'm holding onto hope for both of us.","You are worthy of being chosen.",
    "Your healing is worth waiting for.","I'm here through every wave.","You deserve to feel whole again.",
    "Your light is still there, even if dim.","I'm not letting go.","You are allowed to be human.","There is still love waiting for you.",
    "You deserve to be fought for.","I'm proud of you for surviving today.","Your heart is still good and kind.",
    "You are worthy of gentle hands.","I'm listening with all my heart.","You deserve rest and peace.","Your pain doesn't define you.",
    "I'm here, no matter what.","You are allowed to dream again.","There is still a future worth living for.",
    "You deserve to feel safe in your own skin.","I'm holding you in my heart.","Your story isn't finished.",
    "You are worthy of every good thing.","I'm not going anywhere.","You deserve to heal without shame.",
    "Your existence is important.","I'm proud of how far you've come.","You are allowed to feel everything and still be okay.",
    "There is still light ahead.","You deserve love that stays.","I'm here for every step.","You are not your scars.",
    "Your heart still knows joy.","I'm grateful you're still fighting.","You deserve mornings without dread.",
    "Your pain is temporary — you are not.","I'm holding space for your recovery.","You are worthy of being seen.",
    "There is still music waiting for you.","You deserve to laugh again.","I'm proud of you for not giving up.",
    "Your life is worth every fight.","I'm here, quietly cheering you on.","You are allowed to take up space unapologetically.",
    "There is still softness in your future.","You deserve to feel at home in your body.","I'm not scared of your tears.",
    "You are worthy of gentle love.","Your healing matters.","I'm holding hope until you're ready.","You deserve days that don't hurt.",
    "Your heart is still beating for a reason.","I'm here through every storm.","You are allowed to be soft.",
    "There is still warmth waiting for you.","You deserve to feel proud of yourself.","I'm listening with endless patience.",
    "You are worthy of second chances.","Your pain doesn't make you less lovable.","I'm proud of every small victory.",
    "You deserve to feel understood.","There is still beauty with your name on it.","You are not alone tonight.",
    "I'm here, holding you in my thoughts.","You deserve restful sleep.","Your heart still knows how to love.",
    "I'm grateful for your courage.","You are worthy of being celebrated.","There is still peace coming.",
    "You deserve to feel safe again.","I'm not giving up on your tomorrow.","You are allowed to grieve.",
    "Your light hasn't gone out.","I'm here for every hard moment.","You deserve to feel whole.",
    "There is still laughter in your future.","You are worthy of being held gently.","I'm proud of you for existing.",
    "You deserve days filled with ease.","Your story still has happy chapters.","I'm listening with endless patience.",
    "You are not your worst day.","There is still magic left for you.","You deserve to feel loved without condition.",
    "I'm here, no matter how long it takes.","You are worthy of every sunrise.","Your healing is sacred.",
    "I'm holding you close in my heart.","You deserve to feel seen and known.","There is still joy waiting patiently.",
    "You are allowed to be vulnerable.","I'm proud of you for reaching out.","You deserve to feel at peace.",
    "Your heart is still full of good.","I'm here through every silence.","You are worthy of gentle mornings.",
    "There is still love that chooses you.","You deserve to breathe easier.","I'm not letting go of hope for you.",
    "You are allowed to heal slowly.","Your pain is not the end of your story.","I'm here for every tear and every triumph.",
    "You deserve to feel worthy every day.","There is still a life worth living.","You are not alone in this.",
    "I'm proud of you for still trying.","You deserve to feel safe in your own mind.","Your heart still knows how to hope.",
    "I'm here, always.","You are worthy of every beautiful thing.","There is still light at the end of this tunnel.",
    "You deserve to wake up feeling lighter.","I'm holding space for your joy to return.","You are allowed to heal at your own pace.",
    "Your existence is a quiet miracle.","I'm grateful you're still here with us.","You deserve love that never leaves.",
    "There is still so much good ahead.","You are worthy of being cherished.","I'm here, holding you gently.",
    "You deserve to feel proud of surviving.","Your heart is still beating for beautiful reasons.","I'm not giving up on you.",
    "You are allowed to rest without guilt.","There is still laughter waiting for you.","You deserve to feel truly seen.",
    "I'm proud of every breath you take.","You are worthy of gentle days and soft nights.","Your healing is coming.",
    "I'm here through every season.","You deserve to feel at home in yourself.","There is still wonder left in the world for you.",
    "You are not your pain.","I'm holding onto tomorrow for both of us.","You deserve to feel loved exactly as you are.",
    "Your story is still being written.","I'm here, no matter what.","You are worthy of every new beginning.",
    "There is still sunshine with your name on it.","You deserve to feel safe and held.","I'm proud of you for choosing to stay.",
    "Your heart still knows how to heal.","I'm here for every moment.","You are allowed to hope again.",
    "There is still love waiting to find you.","You deserve to wake up without dread.","I'm holding you in light and love.",
    "You are worthy of being fought for.","Your pain will not win.","I'm here, quietly believing in you.",
    "You deserve days that feel like hugs.","There is still joy that belongs to you.","You are not too much.",
    "I'm proud of you for existing today.","You deserve to feel understood and accepted.","Your heart is still good and kind.",
    "I'm here through every wave of feeling.","You are worthy of gentle love and care.","There is still peace waiting patiently.",
    "You deserve to feel whole again.","I'm holding space for your light to return.","You are allowed to be soft and tender.",
    "Your healing matters deeply.","I'm grateful for every day you choose to stay.","You deserve mornings filled with possibility.",
    "There is still magic in your future.","You are worthy of being celebrated.","I'm here, loving you through this.",
    "You deserve to feel safe in your own skin again.","Your story still has so much beauty left.","I'm proud of you for surviving the unsurvivable.",
    "You are not alone anymore.","There is still love that will stay.","You deserve to feel truly at peace.",
    "I'm holding you gently in my heart.","You are worthy of every tomorrow.","Your pain does not define your worth.",
    "I'm here for the long journey.","You deserve to laugh without guilt.","There is still light inside you.",
    "You are allowed to heal without apology.","I'm proud of you for still caring.","You deserve gentle hands and kind words.",
    "Your heart still knows joy.","I'm here, no matter how heavy it feels.","You are worthy of love that never wavers.",
    "There is still hope growing quietly.","You deserve to feel held and safe.","I'm grateful you're still here breathing.",
    "You are not your darkest night.","Your healing is worth every moment.","I'm here, believing in your recovery.",
    "You deserve to feel proud of yourself.","There is still music waiting for you to dance again.","You are worthy of being chosen every day.",
    "I'm holding onto you until you can hold yourself.","You deserve days that feel like coming home.","Your existence is a gift to the world.",
    "I'm proud of you for waking up today.","You are allowed to be loved fiercely.","There is still softness waiting for you.",
    "You deserve to feel truly alive again.","I'm here through every single breath.","You are worthy of gentle mornings.",
    "Your heart is still full of light.","I'm not letting go.","You deserve to feel seen without shame.",
    "There is still love that will never leave.","You are not broken beyond repair.","I'm proud of every step you're still taking.",
    "You deserve to feel safe and loved.","Your story is still unfolding beautifully.","I'm here, loving you through the storm.",
    "You are worthy of every sunrise.","There is still joy that remembers your name.","You deserve to heal without hurry.",
    "I'm holding hope for you gently.","You are allowed to rest deeply.","Your pain will pass — you will not.",
    "I'm grateful for your heartbeat.","You deserve love that stays through everything.","There is still wonder waiting just for you.",
    "You are worthy of being held without condition.","I'm proud of you for choosing life today.","You deserve to feel at peace in your body.",
    "Your heart still knows how to love deeply.","I'm here, always in your corner.","You are allowed to bloom again.",
    "There is still light at the end of this.","You deserve to feel truly known and loved.","I'm holding you close in my thoughts.",
    "You are worthy of gentle, endless love.","Your healing is coming, I promise.","I'm proud of you for surviving yourself.",
    "You deserve days filled with quiet joy.","There is still beauty that needs you here.","You are not alone in this fight.",
    "I'm here, loving you through every moment.","You deserve to feel safe to be yourself.","Your heart is still beating for good reasons.",
    "I'm grateful you chose another day.","You are worthy of love that never fades.","There is still hope growing in the dark.",
    "You deserve to wake up feeling worthy.","I'm holding space for your light.","You are allowed to heal at your own pace.",
    "Your existence matters more than you know.","I'm proud of you for still caring enough to hurt.","You deserve gentle love forever.",
    "There is still a life worth living beautifully.","You are worthy of being cherished deeply.","I'm here, no matter how long the night.",
    "You deserve to feel truly at home again.","Your heart still knows how to heal.","I'm grateful for every breath you take.",
    "You are allowed to be loved exactly as you are.","There is still joy waiting patiently for you.","You deserve to feel safe and seen.",
    "I'm holding you gently through this.","You are worthy of every good thing coming.","Your pain will not have the final say.",
    "I'm proud of you for still being here.","You deserve love that never asks you to shrink.","There is still light inside your chest.",
    "You are not your worst thoughts.","I'm here, loving you fiercely.","You deserve to heal without shame.",
    "Your heart is still good.","I'm grateful you're still fighting.","You are worthy of gentle, endless care.",
    "There is still magic left in your future.","You deserve to feel truly alive.","I'm holding hope until you can carry it again.",
    "You are allowed to rest without guilt.","Your existence is a quiet kind of beautiful.","I'm proud of you for surviving the nights.",
    "You deserve mornings that feel like mercy.","There is still love that will choose you every day.","You are worthy of being held softly.",
    "I'm here through every tear.","You deserve to feel proud of who you are.","Your heart still knows how to hope.",
    "I'm grateful for your resilience.","You are allowed to be loved without earning it.","There is still peace waiting for you.",
    "You deserve to feel safe in your own heart.","I'm holding you in light and love.","You are worthy of every new beginning.",
    "Your healing is sacred and real.","I'm proud of you for choosing to stay.","You deserve love that feels like home.",
    "There is still joy that belongs only to you.","You are not alone anymore.","I'm here, loving you through everything.",
    "You deserve to feel truly at peace.","Your heart is still full of light.","I'm grateful you're still here with us.",
    "You are worthy of gentle, unwavering love.","There is still a beautiful life waiting.","You deserve to feel safe and whole.",
    "I'm holding space for your joy.","You are allowed to heal slowly and softly.","Your existence is deeply important.",
    "I'm proud of every day you choose yourself.","You deserve love that never wavers.","There is still light coming for you.",
    "You are worthy of being loved fiercely.","I'm here, always.","You deserve to feel truly seen and known.",
    "Your heart still knows how to love.","I'm grateful for your courage.","You are allowed to take up all the space you need.",
    "There is still wonder waiting for you.","You deserve gentle days and soft nights.","I'm holding you gently in my heart.",
    "You are worthy of every sunrise.","Your pain does not erase your worth.","I'm proud of you for still trying.",
    "You deserve love that stays.","There is still hope growing quietly.","You are not too much — you are exactly enough.",
    "I'm here, loving you through the storm.","You deserve to feel safe again.","Your heart is still beating for beautiful things.",
    "I'm grateful you chose another sunrise.","You are worthy of love that never leaves.","There is still joy waiting to find you.",
    "You deserve to wake up feeling worthy.","I'm holding onto hope for you.","You are allowed to heal without apology.",
    "Your existence matters immensely.","I'm proud of you for surviving yourself.","You deserve gentle love and endless care.",
    "There is still magic in your future.","You are worthy of being cherished.","I'm here, no matter what.",
    "You deserve to feel truly alive again.","Your heart still knows joy.","I'm grateful for every breath.",
    "You are allowed to be loved exactly as you are.","There is still light at the end.","You deserve peace that stays.",
    "I'm holding you close.","You are worthy of every tomorrow.","Your healing is coming.","I'm proud of you for existing.",
    "You deserve love that feels safe.","There is still beauty waiting.","You are not alone.","I'm here, loving you fiercely.",
    "You deserve to heal gently.","Your heart is still good.","I'm grateful you're here.","You are worthy of gentle love.",
    "There is still hope.","You deserve to feel safe.","I'm holding you.","You are loved.","Stay.","I'm here."
  ];

  function add(msg, type='bot') {
    const div = document.createElement('div');
    div.className = `message ${type}`;
    div.innerHTML = msg.replace(/\n/g,'<br>');
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
    if(type!=='user') speechSynthesis.speak(new SpeechSynthesisUtterance(msg.split('<br>')[0]));
  }

  function getReply() {
    if (usedReplies.size >= replies.length) usedReplies.clear(); // reset only when all used
    let available = replies.filter((_, i) => !usedReplies.has(i));
    const chosen = available[Math.floor(Math.random() * available.length)];
    usedReplies.add(replies.indexOf(chosen));
    return chosen;
  }

  function triggerCrisis() {
    const country = (navigator.language.split('-')[1]||"US").toUpperCase();
    const line = HOTLINES[country] || HOTLINES.default;
    add("I'm really worried about you right now.", 'crisis');
    add(`Please reach out RIGHT NOW — help is here 24/7:`, 'crisis');
    add(`${line}`, 'crisis');
    add("You are loved. You matter. Just one more minute.", 'crisis');
    add("Grounding exercise:<br>5 things you see<br>4 you can touch<br>3 you hear<br>2 you smell<br>1 you taste", 'crisis');
  }

  async function sendMessage() {
    const text = input.value.trim();
    if (!text) return;
    add(text, 'user');
    input.value = '';

    const lower = text.toLowerCase();
    const crisisWords = /suicid|kill myself|want to die|end it|no point|self.?harm|cut|overdose/i.test(lower);

    if (crisisWords) {
      triggerCrisis();
      return;
    }

    add(getReply());
  }

  function toggleVoice() {
    if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) return;
    const Rec = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (recognition) { recognition.stop(); recognition = null; return; }
    recognition = new Rec();
    recognition.lang = navigator.language;
    recognition.onresult = e => { input.value = e.results[0][0].transcript; sendMessage(); };
    recognition.start();
  }

  input.addEventListener('keypress', e => { if (e.key === 'Enter') sendMessage(); });
  add("I'm here for you. How are you feeling?");
</script>
</body>
</html>
